window.copyPageText = function() {
  const mainContent = document.querySelector('.main-content');
  if (!mainContent) return;

  const clone = mainContent.cloneNode(true);

  // Verwijder alle ongewenste elementen
  const unwantedSelectors = [
    '.integrity-check', '.integrity-content', '.verify-section', '.hash-verifier',
    '.copy-container', '.copy-feedback', '#verify-feedback', '.verify-feedback',
    '.community-box', '.donation-section',
    '.footer-nav', '.site-footer', '.site-footer-credits', '.page-footer', // <-- dit vangt de Generated by
    '.banner', '.overlay-text', '.home-container', '.language-buttons',
    '.language-selector', '.manifest-header', '.manifest-subtitle',
    '.intro-title', '.intro-text',
    'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'a', 'button', 'script', 'code'
  ];

  clone.querySelectorAll(unwantedSelectors.join(', ')).forEach(el => el.remove());

  // Extra: verwijder paragrafen met uitleg over hash
  clone.querySelectorAll('p').forEach(p => {
    const text = p.textContent.trim();
    if (text.includes('Wat is nu eigenlijk hash verificatie') || 
        text.includes('hash verrificatie') ||
        text.includes('waarom zouden we dat doen')) {
      p.remove();
    }
  });

  // Verwijder elementen met JS-code of "Generated by"
  clone.querySelectorAll('*').forEach(el => {
    const text = el.textContent;
    if (text.includes('document.addEventListener') || 
        text.includes('Generated by') ||
        text.includes('GitHub Pages')) {
      el.remove();
    }
  });

  // Cleanup lege elementen
  clone.querySelectorAll('p, div, section').forEach(el => {
    if (el.textContent.trim().length < 5) el.remove();
  });

  // Pure tekst
  let text = clone.textContent || clone.innerText || '';
  text = text.replace(/\s+/g, ' ').replace(/\n{3,}/g, '\n\n').trim();

  // Kopieer met feedback
  navigator.clipboard.writeText(text).then(() => {
    const feedback = document.getElementById('copy-feedback');
    if (feedback) {
      const lang = document.documentElement.lang || 'nl';
      const copiedText = lang === 'en' ? '✓ Pagina tekst gekopieerd!' : '✓ Pagina tekst gekopieerd!';
      feedback.innerHTML = `<span style="color: #66ff66 !important; font-weight: bold;">${copiedText}</span>`;
      setTimeout(() => feedback.innerHTML = '', 3000);
    }
  }).catch(() => {
    const feedback = document.getElementById('copy-feedback');
    if (feedback) {
      const lang = document.documentElement.lang || 'nl';
      const errorText = lang === 'en' ? 'Copy mislukt – selecteer handmatig' : 'Copy mislukt – selecteer handmatig';
      feedback.innerHTML = `<span style="color: #ff6666 !important;">${errorText}</span>`;
    }
  });
};